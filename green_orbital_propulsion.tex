% --------------------------------------------------------------
% This is all preamble stuff that you don't have to worry about.
% Head down to where it says "Start here"
% --------------------------------------------------------------
 
\documentclass[12pt]{article}
 
\usepackage[margin=1in]{geometry} 
\usepackage{amsmath,amsthm,amssymb}
\usepackage[margin=1in]{geometry} 
\usepackage{amsmath,amsthm,amssymb}
\usepackage[english]{babel} 
\usepackage[T1]{fontenc} %escribe lo del teclado
\usepackage[utf8]{inputenc} %Reconoce algunos s√≠mbolos
\usepackage{lmodern} %optimiza algunas fuentes
\usepackage{graphicx}
\graphicspath{ {images/} }
\usepackage[urlcolor=blue,colorlinks=true]{hyperref}
\usepackage{makecell}
\usepackage{adjustbox}
\usepackage[justification=centering]{caption}
\usepackage[style=alphabetic]{biblatex}  
\addbibresource{references/papers.bib}  
\setlength{\parindent}{0em} 
\usepackage{listings}
 
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
 
\newenvironment{theorem}[2][Theorem]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{lemma}[2][Lemma]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{exercise}[2][Exercise]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{problem}[2][Problem]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{question}[2][Question]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{corollary}[2][Corollary]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}

\newenvironment{solution}{\begin{proof}[Solution]}{\end{proof}}
 
\begin{document}
 
% --------------------------------------------------------------
%                         Start here
% --------------------------------------------------------------
 
\title{Green Orbital Propulsion System for a Small Satellite}
\author{Christian Molli\`ere}
\maketitle
\newpage

% B1
\section{Reference Case Definition}
\label{chap:reference_case}
Most the orbital propulsion systems used for AOCS tasks don't need to provide a very high amount of $\Delta v$ to the satellite bus. Therefore, lightweight and simple blow-down feed systems (see Figure \ref{fig:blowdown_system}) are usually implemented to supply the propellant to the engines. Usually an injector is used to evenly distribute the fuel within the combustion chamber leading to a pressure loss of $\Delta p_{\text{injector}}$ along the fuel line.\\

\begin{figure}[!h]
	\centering
	\includegraphics[width=\linewidth]{figures/blowdown_sketch}
	\caption{Simplified view of a pressure blow down system used to transport propellant to the engine. The pressurant and the propellant are separated by a diaphram.}
	\label{fig:blowdown_system}
\end{figure}

We will assume the following injection pressure loss, since neither the chamber pressure $p_c$ nor the pressure loss at the injector $\Delta p_{\text{injector}}$ are commonly cited in propulsion system specifications.
\begin{equation}
	\Delta p_{\text{injector}} \approx \frac{1}{2}p_c 
	\label{eq:injector_loss_assumption}
\end{equation}

This will lead to an estimated chamber pressure using Equation (\ref{eq:injector_loss_assumption}) as shown in the following.
\begin{gather}
	p_{\text{feed}} = p_c + \Delta p_{\text{injector}} \\
	\rightarrow \quad p_c \approx \frac{2}{3} p_{\text{feed}}
	\label{eq:chamber_pressure_estimation}
\end{gather}

During our internet research the propulsion systems in Table \ref{tab:reference} were found. All systems use monopropellants and are used for AOCS tasks of the spacecraft. In the following we will use the \textbf{XMM Thruster} as a reference case using a feeding pressure of $p_{\text{feed}}=5.5\text{bar}-24\text{bar}$ and a nozzle expansion ratio of $\epsilon=60$.\\

\begin{table}[h!]
	\centering
	\begin{tabular}{|c|c|c|c|}
		\hline
		Case & \makecell{Chamber\\ Pressure {[}bar{]}} & Expansion Ratio & \makecell{Initial Propellant\\ Temperature {[}K{]}} \\ \hline
		XMM Thruster                      &        3.67-16         &  60   &              293.15                      \\ \hline
	\end{tabular}
	\caption{Parameters needed for NasaCEA calculations based on the reference case of the XMM thruster system.}
	\label{tab:selected_reference_case}
\end{table}

Using Equation (\ref{eq:chamber_pressure_estimation}) we can translate the feeding pressure of the XMM Thruster system to a chamber pressure of $p_{c}=3.67\text{bar}-16\text{bar}$. Furthermore, an initial propellant temperature of $20^\circ\text{C}$ was assumed for all calculations. The reference case is summarized in Table \ref{tab:selected_reference_case}.
 
% B2
\section{Propellants Comparision}
Using the parameters of the reference case in Table \ref{tab:selected_reference_case} the following green propellants in Table \ref{tab:comparison} were investigated using NASA CEA. The reaction products were set to frozen from the nozzle on outwards, to prevent further reaction in the nozzle as demanded in the task description.

\begin{table}[!h]
	\centering
	\begin{tabular}{|c|c|c|}
		\hline
		Propellant & Vacuum Specific Impulse {[}s{]} & Combustion Temperature {[}K{]} \\ \hline
		LMP-103S   & 253.2 & 1864-1865  \\ \hline
		AF-M315E   & 261  & 2102-2105  \\ \hline
		H2O2, 98\% & 188   & 1225    \\ \hline     
	\end{tabular}\\
	\caption{Comparison of green propellants to the reference case. Each calculation is done using the minimum and maximum feeding pressure of the reference case. If only one result is displayed no difference was calculated between max. and min. chamber pressure.}
	\label{tab:comparison}
\end{table}

% B3
\section{Propellant Optimization}
\label{chap:task_b3}
To optimize the propellant composition of Methanol, ADN and Water a rocketCEA script was written in Python. It performs a search on a composition grid, with a step size of $1\%$ weight fraction. It iterates through all possible composition permutations. The input parameters were taken from the reference case in Table \ref{tab:selected_reference_case} using only the maximum chamber pressure. The results are discussed in the following.

\paragraph{All results}
The top figure in Figure \ref{fig:fuel_optimization_all_results} shows the result of the optimization with a maximum specific impulse in vacuum of $I_{sp}=301.43s$ using $17\%$ of Methanol, $83\%$ ADN and $0\%$ Water.

\paragraph{Final result}
The task demanded a combustion temperature below 1000$^\circ$C (1273.15K). Hence, all results with a higher combustion temperature were removed from the lower figure of Figure \ref{fig:fuel_optimization_all_results}. This lead to the final result with a maximum specific impulse in vacuum of $I_{sp}=236.50s$ using $39\%$ of Methanol, $59\%$ ADN and $2\%$ Water.\\

Furthermore, we need to consider that solid ADN will need to be dissolved in the other two components of the propellant. At a temperature of $20^\circ C$, which is coherent with our initial propellant temperature, $s_{\text{ADN,H2O}}=3.56$ times more Water than ADN is needed to completely dissolve the ADN. Methanol can dissolve much more ADN at a rate of only $s_{\text{ADN,Meth}}=0.86$ \cite{Larsson2011}. The solubility $s$ is defined as\\
\begin{equation}
	s_{a,b} = \frac{m_b}{m_a} .
\end{equation}

The used $39\%$ Methanol can dissolve $45.35\%$ of ADN. The remaining $13.65\%$ of ADN would need to be dissolved by the propellants $2\%$ of Water, which can only dissolve $0.56\%$ of ADN at a temperature of 20$^\circ$C. Therefore, the found propellant composition would contain $13.09\%$ of solid ADN, which would make it unusable under real conditions.\\

Optimizing the propellant composition to comply with the mentioned solubility constraint is beyond the scope of this task and shall only be mentioned here.

% B4
\section{Thruster Preliminary Design}
The new propulsion system should provide the same amount of thrust as the reference case beeing 20N. With thrust $F$ beeing defined as
\begin{equation*}
	F = I_{sp} \cdot \dot{m}_{\text{prop}} \cdot g \overset{!}{=} 20\text{N}.
\end{equation*}
Therefore, the needed mass flow rate $\dot{m}_{\text{prop}}$ is calculated using the earth's gravitational acceleration of $g=9.81\frac{m}{s^2}$ and the determined specific impulse of task B3 of $I_{sp}=236.5s$.
\begin{equation*}
	\dot{m}_{\text{prop}} = 0.00862 \frac{\text{kg}}{\text{s}} = 8.62 \frac{\text{g}}{\text{s}}
\end{equation*}
Furthermore, to reach the same amount of total impulse $I_{\text{total}}=517000\text{Ns}$ (see Table \ref{tab:reference}) the propellant mass $m_{\text{prop}}$ can be calculated to be
\begin{equation*}
	m_{\text{prop}} = \frac{I_{\text{Total}}}{F} \cdot \dot{m}_{\text{prop}} =  211.97\text{kg}
\end{equation*}
Using NASA CEA the complete output is computed for the propellant composition found in Section \ref{chap:task_b3}. It can be found on Page \pageref{chap:cea_output} to obtain the characteristic exhaust speed $c^*=4240.4\frac{\text{ft}}{\text{s}}=1292.5\frac{\text{m}}{\text{s}}$.From here we can calculate the needed throat area $A_t$ to
\begin{equation*}
	A_t = \frac{c^* \cdot \dot{m}_{\text{prop}}}{p_c} = 6.96 \cdot 10^{-6} \text{m}^2.
\end{equation*}
Using the expansion ratio $\epsilon=60$ this leads to a nozzle exit area $A_e$ of
\begin{equation*}
A_e = \epsilon * A_t = 4.18 \cdot 10^{-4} \text{m}^2.
\end{equation*}

% B5
\section{Detailed Design Blow-Down Feed System}
% TODO design BOL and EOL pressure (BOL=16bar)
% TODO study thrust along pressure 
% TODO define feeding system architecture (classic Blow-Down System...)
% TODO calculate amount of pressurant needed
% TODO calculate dimensions of propellant and pressurant tanks

% Optimzation results
\newpage
\begin{figure}[!h]
	\centering
	\includegraphics[width=0.8\linewidth]{figures/b3_1.pdf}
	\includegraphics[width=0.8\linewidth]{figures/b3_2.pdf}
	\caption{Figure showing the fuel optimization using Nasa CEA to compute the highest possible ISP (top). The best results are highlighted with a red cross. The second figure shows the best result after all reactions with a combustion temperature above 1000$^\circ$C (1273.15K) are removed (bottom).}
	\label{fig:fuel_optimization_all_results}
\end{figure}

% Overview
\newpage
\begin{adjustbox}{angle=90, center,caption={Overview of small propulsion systems using monopropellants.}}%,float=table}
	\begin{tabular}{|c|c|c|c|c|c|c|}
		\hline
		Name & Propellants & \makecell{Number of\\Thrusters} & \makecell{Thruster\\Class {[}N{]}} & \makecell{Total\\Impulse [Ns]} & Other & References\\ \hline
		
		\makecell{XMM\\Thruster} & N2H4 & 8 & 20 & \makecell{$>517000$}  & \makecell{$I_{sp}=222-230s$,\\$p_{\text{feed}}=5.5-24\text{bar}$,\\$\epsilon=60$} & \makecell{ \cite{EsaXMM} \cite{ariane20N}} \\ \hline
		
		\makecell{TanDEM-X\\Thruster} & \makecell{N2H4} & 4 & 1 & \makecell{$>135000$}& \makecell{$I_{sp}=200-223s$,\\$p_{\text{feed}}=5.5-22\text{bar}$,\\$\epsilon=80$\\} & \makecell{\cite{tandemX} \cite{ariane1N}}\\ \hline
		
		\makecell{Prisma\\Thruster}& LMP-103S & 2 & 1 & \makecell{$\approx 108773$} & \makecell{$I_{sp}=204-231s$,\\$p_{\text{feed}}=4.5-22\text{bar}$,\\$\epsilon=100$} & \cite{hpgpThruster} \\ \hline
		\label{tab:reference}
	\end{tabular}
\end{adjustbox}

% Appendix
\newpage
\section{NASA CEA Output for Optimized Propellant}
\label{chap:cea_output}
\lstinputlisting{results/b4.out}

% References
\newpage
\printbibliography 
 
\end{document}